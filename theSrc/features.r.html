<!doctype html>
<html>
  <body>
    <script src="external/lodash.min.js"></script>
    <script src="external/jquery.min.js"></script>

    <pre style="padding-left:20px" class="pre-content"></pre>
    <!-- NB This script should be defined before rhtmlTemplate.js is loaded-->
    <script>

      $('.pre-content').append($('<span>').html('library("devtools")'));
      $('.pre-content').append($('<br>'));
      // TEMPLATE! - update the repo name here
      $('.pre-content').append($('<span>').html('install_github("NumbersInternational/rhtmlTemplate")'));
      $('.pre-content').append($('<br>'));
      $('.pre-content').append($('<br>'));

      $(document).ready( function() {
        console.log("Document ready. Fetching features");


        $.ajax('./features/features.json').done(function (response) {

          _.forEach(response.features, function(feature) {
            $('.pre-content').append($('<span>').html('#' + feature.name));
            $('.pre-content').append($('<br>'));
            _.forEach(feature.scenarios, function(scenario) {
              $('.pre-content').append($('<span>').html('##' + scenario.name));
              $('.pre-content').append($('<br>'));
              _.forEach(scenario.description, function(line) {
                $('.pre-content').append($('<span>').html('###' + line));
                $('.pre-content').append($('<br>'));
              });


              // TEMPLATE! - this code is specific for your widget and may need to be updated
              rCommand = "rhtmlTemplate::template('" + JSON.stringify(scenario.config) + "')";

              $('.pre-content').append($('<span>').html(rCommand));
              $('.pre-content').append($('<br>'));
              $('.pre-content').append($('<br>'));

            });
          });

        }).fail( function(error) {
          console.error("Download of ./features/features.json failed. Probably invalid JSON.");
          console.error(error);
          $('body').append($('<div>').text("Failure to download/parse ./features/features.json (probably invalid JSON). See dev tools console for error logging."));
        });
      });
    </script>

  </body>
</html>
