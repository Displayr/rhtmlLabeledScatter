<!doctype html>
<html>
  <body>
    <script src="external/lodash.min.js"></script>
    <script src="external/jquery.min.js"></script>

    <h2>Examples</h2>
    <ul class='example-list'></ul>
    <br/>
    <a href="/scenarios.r.html">Examples in an R Script</a>
    <br/>
    <a href="/experiments">Single page test/experiments</a>
  </body>
  <script>

    generateExampleLinks = function() {
      var exampleList = $('.example-list');

      $.ajax('./resources/data/features.json').done(function (response) {
        _.forEach(response.features, function (feature, featureIndex) {
          var feature = response.features[featureIndex];
          var featureItem = $('<li>');
          var featureTitle = $('<h2>').html(feature.name);
          featureItem.append(featureTitle);

          var featureList = $('<ul>');

          _.forEach(feature.scenarios, function (scenario, scenarioIndex) {
            var listItem = $('<li>');
            var link = "render.html?featureIndex=" + featureIndex + "&scenarioIndex=" + scenarioIndex;

            var scenario = feature.scenarios[scenarioIndex];
            var anchor = $('<a>').html(scenario.name)
              .attr('href', link)

            featureList.append(listItem.append(anchor));

          });

          exampleList.append(featureItem.append(featureList));

        });
      }).fail( function(error) {
        console.error("Download of ./resources/data/features.json failed. Probably invalid JSON.");
        console.error(error);
        $('body').append($('<div>').text("Failure to download/parse ./resources/data/features.json (probably invalid JSON). See dev tools console for error logging."));
      });
    }

    $(document).ready(generateExampleLinks);
  </script>
</html>
